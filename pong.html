<html>
<div id="board">
    <div id="blue">
    </div>
    <div id="red">
    </div>
    <div id="ball">
    </div>
</div>

<script>

class Colourable {
    constructor(position, colour, dimensions){
        this.position = position;
        this.colour = colour;
        this.dimensions = dimensions;
        this.element = document.createElement("div");
        document.appendChild(this.element);
    }
}

class Mover extends Colourable{
    constructor(velocity, position, colour, dimensions){
        super(position, colour, dimensions);
        this.velocity = velocity;
    }

   move(){
       this.position.x += this.velocity.dx;
       this.position.y += this.velocity.dy;
       this.element.style.left = this.position.x + "px";
       this.element.style.top = this.position.y + "px";
   }
}

const board = document.getElementById("board");
const blue = document.getElementById("blue");
const red = document.getElementById("red");
const ball = document.getElementById("ball");
board.style.backgroundColor = "green";
board.style.width = "400px";
board.style.height = "250px";
board.style.top = "0";
board.style.left = "0";
ball.style.backgroundColor = "black";
ball.style.width = "10px";
ball.style.height = "10px";
ball.style.top = "120px";
ball.style.left = "195px";
blue.style.backgroundColor = "blue";
blue.style.width = "60px";
blue.style.height = "10px";
blue.style.top = "0";
blue.style.left = "170px";
red.style.backgroundColor = "red";
red.style.width = "60px";
red.style.height = "10px";
red.style.top = "240px";
red.style.left = "170px";
const items = [board, blue, red, ball];
for (let i = 0; i < items.length; i++){
    items[i].style.position = "absolute";
}
document.addEventListener("keydown", function(theEvent){
    let currentPosition = parseInt(blue.style.left);
    if (theEvent.key == "ArrowRight"){
        currentPosition += 15;
    } else if (theEvent.key == "ArrowLeft"){
        currentPosition -= 15;
    }
    blue.style.left = currentPosition + "px";
});
let deltaLeft = 2;
let deltaTop = 2;
let redPaddleLeft = 170;

const hitTopWall = function(){
    deltaTop = -deltaTop;
    deltaTop = deltaTop + 0.5;
    deltaTop = Math.min(deltaTop, 5);
}

const hitBottomWall = function(){
    deltaTop = -deltaTop;
    deltaTop = deltaTop - 0.5;
    deltaTop = Math.max(deltaTop, -5);
}


const mainGameLoop = function(){
    let currentLeft = parseInt(ball.style.left);
    let currentTop = parseInt(ball.style.top);
    if (currentTop >= 230){
        hitBottomWall();
    } 
    if (currentTop <= 10){
        let playerOne = parseInt(blue.style.left);
        if((currentLeft + 10) < playerOne || currentLeft > (playerOne + 60)){
            alert("I'm sorry you lost. You're still okay.")
            return;}
        hitTopWall();
    } 
    if (currentLeft >= 390 || currentLeft <= 0){
        deltaLeft = -deltaLeft;
    }  
    ball.style.left = currentLeft + deltaLeft + "px";
    ball.style.top = currentTop + deltaTop + "px";
    
    // nastyComputerMakesItsNastyMove()
    //document.getElementById("red").style.animationDelay = "200s"
    if (redPaddleLeft - parseInt(ball.style.left) > 0){
        redPaddleLeft = redPaddleLeft - 1.9;
        //right
    }
    if (redPaddleLeft - parseInt(ball.style.left) < 0){
        redPaddleLeft = redPaddleLeft + 1.9;
        //left
    }
    console.log(redPaddleLeft);
    red.style.left = Math.round(redPaddleLeft) + "px";


    // if (currentLeft < red.style.left || currentLeft > (red.style.left + 60)){
    //     alert("You won! Go you!")
// }
    // window.requestAnimationFrame(mainGameLoop);
};


document.addEventListener("keydown", function(event){
    console.log(event);
    if (event.key == "."){
        mainGameLoop();
    }
});
mainGameLoop();
</script>